"use strict";var IMAGE_ROOT="img/";window.addEventListener("load",function(){var t=[IMAGE_ROOT+"c-sharp.png",IMAGE_ROOT+"c-sharp.png",IMAGE_ROOT+"java.png",IMAGE_ROOT+"java.png",IMAGE_ROOT+"python.png",IMAGE_ROOT+"python.png",IMAGE_ROOT+"php.png",IMAGE_ROOT+"php.png",IMAGE_ROOT+"swift.png",IMAGE_ROOT+"swift.png",IMAGE_ROOT+"go.png",IMAGE_ROOT+"go.png",IMAGE_ROOT+"js.png",IMAGE_ROOT+"js.png",IMAGE_ROOT+"flutter.png",IMAGE_ROOT+"flutter.png",IMAGE_ROOT+"c++.png",IMAGE_ROOT+"c++.png"],n=document.getElementById("grid");t.forEach(function(t){var e=buildCard(t);n.appendChild(e)});var e=document.getElementsByClassName("card"),s=document.getElementById("display"),i=new Timer(s),o=document.getElementById("flip"),r=document.getElementById("success"),a=new Sound(o,r),c=document.getElementById("failures"),l=document.getElementById("btn-sound"),u=document.getElementById("btn-reset"),d=new Control(l,u);new Game(e,t,i,a,c,d)});var gameEfect,Control=function(){function t(t,e){this.btnReset=e,this.btnSoundEfect=t}return t.prototype.getBtnSoundEfect=function(){return this.btnSoundEfect},t.prototype.getBtnReset=function(){return this.btnReset},t}(),CARD_FLIP_TRANSITION_TIME=800,Game=function(){function t(t,e,n,s,i,o){this.turn=1,this.card1=null,this.card2=null,this.blockFlip=!1,this.failuresCount=0,this.cards=t,this.images=shuffle(e),this.timer=n,this.sound=s,this.failuresDisplay=i,this.control=o,this.setEvents();for(var r=0;r<this.cards.length;r++)this.cards[r].classList.remove("block"),this.cards[r].getElementsByClassName("img-back")[0].setAttribute("src",this.images[r])}return t.prototype.setEvents=function(){var n=this,t=this;this.control.getBtnSoundEfect().addEventListener("click",function(){t.onSoundEfect()}),this.control.getBtnReset().addEventListener("click",function(){t.onReset()});for(var s=this,e=0;e<this.cards.length;e++)!function(e){s.cards[e].addEventListener("click",function(t){n.onClickCard(e)})}(e)},t.prototype.onClickCard=function(r){var a;this.isEndGame()?console.log("End game"):(this.timer.start(),this.isCardBlocked(r)?console.log("> Carta já retirada"):this.isSelectedCard(r)?console.log("> carta já selecionado"):(this.cards[r].classList.add("flip"),this.sound.play(gameEfect.flip),a=this,setTimeout(function(){var t,e,n,s,i,o;1==a.turn?(a.card1=a.cards[r],a.turn=2):(a.card2=a.cards[r],a.turn=1,(null===(t=a.card1)||void 0===t?void 0:t.getElementsByClassName("img-back")[0].getAttribute("src"))==(null===(e=a.card2)||void 0===e?void 0:e.getElementsByClassName("img-back")[0].getAttribute("src"))?(console.log("> imagens iguais"),null!==(n=a.card1)&&void 0!==n&&n.classList.add("block"),null!==(s=a.card2)&&void 0!==s&&s.classList.add("block"),a.sound.play(gameEfect.success)):(console.log("> imagens diferente"),a.sound.play(gameEfect.flip),null!==(i=a.card1)&&void 0!==i&&i.classList.remove("flip"),null!==(o=a.card2)&&void 0!==o&&o.classList.remove("flip"),a.increaseFailures()),a.card1=null,a.isEndGame()&&(a.timer.pause(),console.log("Fim do jogo"),Swal.fire({title:"Congratulations",text:"You won in "+timeFormat(a.timer.getTime())+" with "+a.failuresCount+" failures",icon:"success",allowOutsideClick:!1,willClose:function(){a.restart()}})))},CARD_FLIP_TRANSITION_TIME)))},t.prototype.restart=function(){this.shuffle()},t.prototype.onReset=function(){this.sound.play(gameEfect.flip),this.showCards(),this.shuffle()},t.prototype.onSoundEfect=function(){this.sound.isEnabledSoundEfect()?(this.sound.setEnabledSoundEfect(!1),this.control.getBtnSoundEfect().innerHTML='<i class="fas fa-volume-off fa-lg"></i>'):(this.sound.setEnabledSoundEfect(!0),this.control.getBtnSoundEfect().innerHTML='<i class="fas fa-volume-up fa-lg"></i>')},t.prototype.isSelectedCard=function(t){return this.cards[t]==this.card1},t.prototype.isCardBlocked=function(t){return this.cards[t].classList.contains("block")},t.prototype.resetFailures=function(){this.failuresCount=0,this.failuresDisplay.innerHTML="0"},t.prototype.increaseFailures=function(){this.failuresCount++,this.failuresDisplay.innerHTML=""+this.failuresCount},t.prototype.showCards=function(){for(var t=0;t<this.cards.length;t++)this.cards[t].classList.add("flip")},t.prototype.hideCards=function(){for(var t=0;t<this.cards.length;t++)this.cards[t].classList.remove("flip")},t.prototype.shuffle=function(){var e=this;this.timer.reset(),this.resetFailures(),setTimeout(function(){e.sound.play(gameEfect.flip),e.hideCards(),setTimeout(function(){e.images=shuffle(e.images);for(var t=0;t<e.cards.length;t++)e.cards[t].classList.remove("block"),e.cards[t].getElementsByClassName("img-back")[0].setAttribute("src",e.images[t])},CARD_FLIP_TRANSITION_TIME+100)},CARD_FLIP_TRANSITION_TIME+100)},t.prototype.isEndGame=function(){for(var t=0;t<this.cards.length;t++)if(!this.cards[t].classList.contains("block"))return!1;return!0},t}();!function(t){t[t.flip=0]="flip",t[t.success=1]="success"}(gameEfect=gameEfect||{});var Sound=function(){function t(t,e){this.enabledSoundEfects=!0,this.flipCardSound=t,this.sucessSound=e}return t.prototype.isEnabledSoundEfect=function(){return this.enabledSoundEfects},t.prototype.setEnabledSoundEfect=function(t){this.enabledSoundEfects=t},t.prototype.play=function(t){if(this.enabledSoundEfects){var e;switch(t){case gameEfect.flip:e=this.flipCardSound;break;case gameEfect.success:e=this.sucessSound;break;default:return}e.currentTime=0,e.play()}},t}(),Timer=function(){function t(t){this.interval=NaN,this.time=0,this.beforeTime=0,this.display=t}return t.prototype.setTime=function(t){this.time=t},t.prototype.getTime=function(){return this.time},t.prototype.start=function(){var s;isNaN(this.interval)&&(this.beforeTime=Date.now(),(s=this).interval=setInterval(function(){var t=Date.now(),e=t-s.beforeTime,n=s.getTime()+e;s.setTime(n),s.beforeTime=t,s.clock()},1e3))},t.prototype.clock=function(){this.display.innerHTML=timeFormat(this.time)},t.prototype.pause=function(){clearInterval(this.interval),this.interval=NaN},t.prototype.reset=function(){clearInterval(this.interval),this.interval=NaN,this.time=0,this.display.innerHTML="00:00"},t}(),SECONDS=1e3,MINUTES=60*SECONDS,HOURS=60*MINUTES;function buildCard(t){var e=document.createElement("div");return e.className="card",e.insertAdjacentHTML("afterbegin",'\n        <div class="front">       \n            <img src="img/card-back.png">\n        </div>\n        <div class="back">\n            <div>\n                <img class="img-back" src='+t+">\n            </div>         \n        </div>\n    "),e}function leftPad(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}function shuffle(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(Math.random()*(e+1)),s=[t[n],t[e]];t[e]=s[0],t[n]=s[1]}return t}function timeFormat(t){var e=Math.floor(t%HOURS/MINUTES),n=Math.floor(t%MINUTES/SECONDS);return leftPad(e,2)+":"+leftPad(n,2)}